{% extends "app/base.html" %}

{% block content %}
<div style="padding: 20px;">
    <h1>Library Management Dashboard</h1>
    <p>Welcome! Here is an overview of the library's current status:</p>

    <div style="display: flex; gap: 20px; margin-top: 20px;">
        <div style="flex: 1; background: #f0f4f8; padding: 20px; border-radius: 10px; border-bottom: 4px solid #2c3e50;">
            <h4 style="margin: 0; color: #555;">Total Books</h4>
            <h2 style="margin: 10px 0 0 0;">{{ total_books }}</h2>
        </div>
        
        <div style="flex: 1; background: #f0f4f8; padding: 20px; border-radius: 10px; border-bottom: 4px solid #27ae60;">
            <h4 style="margin: 0; color: #555;">Registered Members</h4>
            <h2 style="margin: 10px 0 0 0;">{{ total_members }}</h2>
        </div>

        <div style="flex: 1; background: #f0f4f8; padding: 20px; border-radius: 10px; border-bottom: 4px solid #e74c3c;">
            <h4 style="margin: 0; color: #555;">Active Borrows</h4>
            <h2 style="margin: 10px 0 0 0;">{{ active_borrows }}</h2>
        </div>
    </div>

    <div style="margin-top: 40px;">
        <h3>Quick Tasks</h3>
        <div style="display: flex; gap: 10px; flex-wrap: wrap;">
            <a href="{% url 'book_list' %}" style="padding: 10px 20px; background: #2c3e50; color: white; text-decoration: none; border-radius: 5px;">View Catalog</a>
            <a href="{% url 'add_book' %}" style="padding: 10px 20px; background: #34495e; color: white; text-decoration: none; border-radius: 5px;">+ Add New Book</a>
            <a href="{% url 'issue_book' %}" style="padding: 10px 20px; background: #27ae60; color: white; text-decoration: none; border-radius: 5px;">Issue Book</a>
            <a href="{% url 'reports' %}" style="padding: 10px 20px; background: #95a5a6; color: white; text-decoration: none; border-radius: 5px;">View Reports</a>
        </div>
    </div>

    <div style="margin-top: 40px;">
        <h3>Recent Transactions</h3>
        <div style="overflow-x: auto;">
            <table style="width: 100%; border-collapse: collapse; margin-top: 10px; background: white;">
                <thead>
                    <tr style="background-color: #f8f9fa; border-bottom: 2px solid #dee2e6;">
                        <th style="padding: 12px; text-align: left; border: 1px solid #ddd;">Book Title</th>
                        <th style="padding: 12px; text-align: left; border: 1px solid #ddd;">Member</th>
                        <th style="padding: 12px; text-align: left; border: 1px solid #ddd;">Status</th>
                        <th style="padding: 12px; text-align: left; border: 1px solid #ddd;">Action</th>
                    </tr>
                </thead>
                <tbody>
                    {% for borrow in recent_borrows %}
                    <tr style="border-bottom: 1px solid #eee;">
                        <td style="padding: 12px; border: 1px solid #ddd;">{{ borrow.book.title }}</td>
                        <td style="padding: 12px; border: 1px solid #ddd;">{{ borrow.member.name }}</td>
                        <td style="padding: 12px; border: 1px solid #ddd;">
                            {% if borrow.status == 'Borrowed' %}
                                <span style="color: #d35400; background: #fef5e7; padding: 4px 8px; border-radius: 4px;">Borrowed</span>
                            {% else %}
                                <span style="color: #27ae60; background: #e9f7ef; padding: 4px 8px; border-radius: 4px;">Returned</span>
                            {% endif %}
                        </td>
                        <td style="padding: 12px; border: 1px solid #ddd;">
                            {% if borrow.status == 'Borrowed' %}
                                <a href="{% url 'return_book' borrow.id %}" 
                                   style="color: #e74c3c; text-decoration: none; font-weight: bold;"
                                   onclick="return confirm('Mark this book as returned?')">Return Book</a>
                            {% else %}
                                <span style="color: #95a5a6;">N/A</span>
                            {% endif %}
                        </td>
                    </tr>
                    {% empty %}
                    <tr>
                        <td colspan="4" style="padding: 20px; text-align: center; color: #888; border: 1px solid #ddd;">No recent transactions found.</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</div>
{% endblock %}